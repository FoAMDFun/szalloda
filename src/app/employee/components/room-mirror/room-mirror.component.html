<section class="container-fluid pt-5">
  <h1 class="text-center fw-bold">Szobatükör</h1>
  <div class="container text-center my-4">
    <button class="btn btn-primary rounded-circle paginate" (click)="shiftOneWeekLeft()">
      <fa-icon [icon]="icons.doublePrevious"></fa-icon>
    </button>
    <button class="btn btn-primary rounded-circle paginate mx-1" (click)="shiftOneDayLeft()">
      <fa-icon [icon]="icons.previous"></fa-icon>
    </button>
    <button class="btn btn-primary rounded-circle paginate me-1" (click)="shiftOneDayRight()">
      <fa-icon  [icon]="icons.next"></fa-icon>
    </button>
    <button class="btn btn-primary rounded-circle paginate" (click)="shiftOneWeekRight()">
      <fa-icon  [icon]="icons.doubleNext"></fa-icon>
    </button>
  </div>
  <table class="table text-center table-striped table-bordered m-auto ">
    <thead>
      <tr [ngStyle]="{'height': styles.tdHeight+'px'}">
        <th scope="col" [ngStyle]="{'width': styles.td1Width+'px'}" >Szoba</th>
        <th scope="col" *ngFor="let date of currentDatesslice(0,(currentDateLenght | async))"
        [ngStyle]="{'width': styles.tdWidth+'px'}"
        [ngClass]="{'bg-warning': isWeekend(date),
        'bg-danger': dateIsToday(date),
        'text-white': dateIsToday(date)}"
        >{{date | date:'MM.dd'}}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let room of rooms$ |async | sort : 'numberOf'"  class="align-middle"
      [ngStyle]="{'height': styles.tdHeight+'px'}">
        <td [ngStyle]="{'width': styles.td1Width+'px'}">{{room.numberOf}}</td>
          <td *ngFor="let date of currentDatesslice(0,(currentDateLenght | async)) as slicedDates;index as i"
          [ngStyle]="{'width': styles.tdWidth+'px'}"
          [ngClass]="{'bg-warning': isWeekend(date),
          'bg-danger': dateIsToday(date)}"
          >
          <ng-container *ngIf="(getReservationByRoomIdandDate(room._id, date) | async)?.colspan as colspan">
            <button *ngIf="getReservationByRoomIdandDate(room._id, date) | async as cellReservation"
              (click)="test(cellReservation.reservation)"
              class="btn btn-primary  position-absolute p-0"
              [ngStyle]="{
                'transform': 'translate(-'+styles.btnWidth/2+'px, -50%)',
                'width': styles.tdWidth*(colspan+i<=slicedDates.length?colspan:slicedDates.length-i)-(styles.tdWidth-styles.btnWidth)+'px',
                'height': styles.btnHeight+'px'}"
              >
              {{cellReservation.reservation._id.slice(0,3)}}
            </button>
          </ng-container>
          </td>
      </tr>
    </tbody>
  </table>

</section>



